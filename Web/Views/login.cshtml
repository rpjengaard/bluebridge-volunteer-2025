@using Umbraco.Cms.Web.Common.PublishedModels;
@using Web.ViewModels;
@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage<BbvLoginPage>
@{
    Layout = "~/Views/Shared/_MasterLayout.cshtml";
    var loginModel = new LoginViewModel { ReturnUrl = Context.Request.Query["returnUrl"] };
    var showForgotPassword = Context.Request.Query["forgot"].ToString() == "true";
    var forgotPasswordSuccess = TempData["ForgotPasswordSuccess"] as bool? ?? false;
    var loginError = TempData["LoginError"] as string;
}
<!DOCTYPE html>
<html lang="da" class="h-full bg-slate-50">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Log ind - Blue Bridge Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Montserrat', sans-serif; }
        h1, h2 { font-family: 'Playfair Display', serif; }
        .bg-blue-bridge { background-color: #23297A; }
        .text-blue-bridge { color: #23297A; }
        .btn-login { background-color: #EE746D; }
        .btn-login:focus, .btn-login:focus-visible { background-color: #3EC58D !important; outline: none; }
    </style>
</head>
<body class="h-full">
<div class="flex min-h-full">
    <div class="flex flex-1 flex-col justify-center px-4 py-12 sm:px-6 lg:flex-none lg:px-20 xl:px-24 bg-white">
        <div class="mx-auto w-full max-w-sm lg:w-96">
            <div>
                <div class="h-12 w-auto bg-blue-bridge flex items-center justify-center text-white font-bold p-2 rounded">
                    BLUE BRIDGE <span class="ml-2 font-light text-xs tracking-widest uppercase">Portal</span>
                </div>

                @if (showForgotPassword)
                {
                    <h2 class="mt-8 text-3xl font-bold tracking-tight text-gray-900">Glemt adgangskode</h2>
                    <p class="mt-2 text-sm text-gray-600">
                        Indtast din email, så sender vi et link til at nulstille din adgangskode.
                    </p>
                }
                else
                {
                    <h2 class="mt-8 text-3xl font-bold tracking-tight text-gray-900">Velkommen tilbage</h2>
                    <p class="mt-2 text-sm text-gray-600">
                        Log ind for at vælge dine vagter til festivalen.
                    </p>
                }
            </div>

            <div class="mt-10">
                @if (forgotPasswordSuccess)
                {
                    <div class="rounded-md bg-green-50 p-4 mb-6">
                        <p class="text-sm text-green-800">
                            Hvis der findes en konto med denne email, har vi sendt et link til at nulstille din adgangskode.
                        </p>
                    </div>
                }

                @if (showForgotPassword)
                {
                    @await Html.PartialAsync("~/Views/Partials/Member/_ForgotPasswordForm.cshtml", new ForgotPasswordViewModel())
                }
                else
                {
                    @if (!string.IsNullOrEmpty(loginError))
                    {
                        <div class="rounded-md bg-red-50 p-4 mb-6">
                            <p class="text-sm text-red-800">@loginError</p>
                        </div>
                    }

                    <form method="post" action="/umbraco/surface/MemberAuthSurface/HandleLogin" class="space-y-6">
                        @Html.AntiForgeryToken()
                        <input type="hidden" name="ReturnUrl" value="@loginModel.ReturnUrl" />

                        <div>
                            <label for="email" class="block text-sm font-medium leading-6 text-gray-900">Email adresse</label>
                            <div class="mt-2">
                                <input id="email" name="Email" type="email" autocomplete="email" required
                                       class="block w-full rounded-md border-0 py-2.5 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-blue-800 sm:text-sm sm:leading-6 px-3">
                            </div>
                        </div>

                        <div>
                            <label for="password" class="block text-sm font-medium leading-6 text-gray-900">Adgangskode</label>
                            <div class="mt-2">
                                <input id="password" name="Password" type="password" autocomplete="current-password" required
                                       class="block w-full rounded-md border-0 py-2.5 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-blue-800 sm:text-sm sm:leading-6 px-3">
                            </div>
                        </div>

                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <input id="remember-me" name="RememberMe" type="checkbox" value="true"
                                       class="h-4 w-4 rounded border-gray-300 text-blue-800 focus:ring-blue-800">
                                <label for="remember-me" class="ml-3 block text-sm leading-6 text-gray-700">Husk mig</label>
                            </div>

                            <div class="text-sm leading-6">
                                <a href="?forgot=true" class="font-semibold text-blue-bridge hover:opacity-80">Glemt adgangskode?</a>
                            </div>
                        </div>

                        <div>
                            <button type="submit"
                                    class="btn-login flex w-full justify-center rounded-md px-3 py-2.5 text-sm font-bold leading-6 text-white shadow-sm hover:opacity-90 uppercase tracking-wider transition-colors">
                                Log ind
                            </button>
                        </div>
                    </form>

                    <p class="mt-10 text-center text-sm text-gray-500">
                        Ikke frivillig endnu?
                        <a href="/tilmeld" class="font-semibold leading-6 text-blue-bridge hover:opacity-80">Tilmeld dig som frivillig</a>
                    </p>
                }
            </div>
        </div>
    </div>

    <div class="relative hidden w-0 flex-1 lg:block">
        <div class="absolute inset-0 bg-blue-bridge opacity-40 mix-blend-multiply z-10"></div>
        <img class="absolute inset-0 h-full w-full object-cover"
             src="https://www.bluebridge.dk/media/5pzf13k1/blue-bridge-2024-19.jpg?rmode=pad&width=1920&v=1daf46ecef20b80"
             alt="Festival stemning">

        <div class="absolute inset-0 z-20 flex items-center justify-center p-12 text-white">
            <div class="max-w-md text-center">
                <blockquote class="text-2xl font-serif italic">
                    "Det er frivilligheden, der bygger broen."
                </blockquote>
                <p class="mt-4 font-semibold uppercase tracking-widest text-sm">- Blue Bridge Festival</p>
            </div>
        </div>
    </div>
</div>

</body>
</html>
